<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>我的日记</title>
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
    <script src="https://cdn.bootcss.com/showdown/1.3.0/showdown.js"></script>
    <script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/9.5.0/highlight.min.js"></script>
    <link href="http://cdn.bootcss.com/highlight.js/9.5.0/styles/monokai_sublime.min.css" rel="stylesheet">
    <script>hljs.initHighlightingOnLoad();hljs.initHighlighting();</script>    
    <script>//leancloud初始化
        function upload_blog(){
            var APP_ID = 'MxUJQ1vKPIj4pInzUlBJzX3c-gzGzoHsz';
            var APP_KEY = 'UR8QvWqGuemCYpOcr8fX4qHM';
            AV.init({
              appId: APP_ID,
              appKey: APP_KEY
            });        
            var Blog_content = AV.Object.extend('blog_content');
            var blog_content_new = new Blog_content();
            var a=document.getElementById("content").value
            blog_content_new.save({
              content: {
              content: document.getElementById("content").value
              }
            }).then(function() {
              location.reload(true);
            }).catch(function(err) {
              alert('error:' + err);
            });	
        }        
    </script>
    <script>//highlight the code
        function highlight_the_code(){
        $(document).ready(function() {
          $('pre code').each(function(i, block) {
            hljs.highlightBlock(block);
          });
        });    
    }
    </script>
    <style>
body{background-color:#f9f9f5;padding:0;border:0}body{font-family:"Microsoft YaHei",微软雅黑,"MicrosoftJhengHei",华文细黑,STHeiti,MingLiu;font-size:14px;line-height:1.42857143}textarea{height:95%;width:49%;display:inline;whit-space:nowrap;float:left;}textarea{font-family:"Microsoft YaHei",微软雅黑,"MicrosoftJhengHei",华文细黑,STHeiti,MingLiu;font-size:18px;line-height:1.42857143;}#counter{font-family:"Microsoft YaHei",微软雅黑,"MicrosoftJhengHei",华文细黑,STHeiti,MingLiu;font-size:18px;line-height:1.42857143}#send{background:red;color:#fff;width:150px;height:30px;font:14px Verdana,Arial,Helvetica,sans-serif}
    </style>
</head>
<body>
    <form id="form" target="hidden_frame">
        <label for="zhichu"></label><input type="hidden" name="zhichu" id="zhichu" value=""/>
        <label for="tomato"></label><input type="hidden" name="tomato" id="tomato" value=""/>
        <label for="sport"></label><input type="hidden" name="sport" id="sport" value=""/>
        <p><input type="submit" name="send" id="send" value="提交" onclick="upload_blog()" />  
        已经输入<span id="counter">0</span>字</p>
        <label for="content"></label><textarea name="content" id="content" onkeyup="compile()" onkeydown="countChar('content','counter')">#标题</textarea>       
        <div id="result" class="markdown">
        </div>     
        <iframe name='hidden_frame' id='hidden_frame'  style="display:none;">
            <script language=JavaScript>   
               parent.location.reload();   
            </script>          
        </iframe>
        <script type="text/javascript">//生成markdown预览
function compile(){var a=document.getElementById("content").value,b=new showdown.Converter,c=b.makeHtml(a);document.getElementById("result").innerHTML=c;highlight_the_code();}function countChar(a,b){document.getElementById(b).innerHTML=document.getElementById(a).value.length}                 </script>   
    </form>
</body>
